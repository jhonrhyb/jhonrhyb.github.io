<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Matrix Developer Portfolio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="./css/style.css">
  <link href="./css/aos@2.3.4.css">
</head>

<body>

  <canvas id="bg"></canvas>

  <div class="content">
    <nav class="navbar">
      <a href="#hero" class="logo">JO</a>
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <ul class="nav-links" id="nav-links">
        <li><a href="#about">About</a></li>
        <li><a href="#skills">Skills</a></li>
        <li><a href="#projects">Projects</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>

    <header class="hero" id="hero">
      <img src="./image/developer.jpg" alt="Developer Avatar" class="hero-img">
      <h1>Hi, I'm <span id="typewriter"></span></h1>
      <!-- <p>Web Developer & Creative Coder</p> -->
      <a href="#projects" class="btn">View My Work</a>
    </header>

    <section id="about">
      <h2>About Me</h2>
      <p>I build modern, interactive web experiences with a strong focus on performance, design, and usability.</p>
    </section>

    <section id="skills">
      <h2>Skills</h2>
      <div class="skill-grid">
        <span>HTML</span>
        <span>CSS</span>
        <span>SQL</span>
        <span>MySQL</span>
        <span>RESTful APIs</span>
        <span>JavaScript</span>
        <span>PHP</span>
        <span>Angular</span>
        <span>Code Igniter</span>
        <span>Laravel</span>
        <span>React</span>
        <span>Three.js</span>
        <span>UI / UX</span>
      </div>
    </section>

    <section id="projects">
      <h2>Projects</h2>
      <div class="projects">
        <div class="project-card">
          <h3>Matrix Portfolio</h3>
          <p>3D animated developer portfolio with WebGL.</p>
        </div>
        <div class="project-card">
          <h3>Landing Page</h3>
          <p>Modern responsive landing page design.</p>
        </div>
      </div>
    </section>

    <section class="contact" id="contact">
      <h2>Contact</h2>
      <p>Email: ortiz.jhonrhyb@gmail.com</p>
    </section>
  </div>

  <!-- ES Module Script for Three.js -->
  <script type="module">
    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.module.js';

    /* =====================
       HELPERS
    ===================== */
    const isDesktop = () => window.innerWidth >= 768;

    /* =====================
       SCENE SETUP
    ===================== */
    const canvas = document.getElementById("bg");
    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(
      75,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.z = 150;

    const renderer = new THREE.WebGLRenderer({
      canvas,
      antialias: true,
      alpha: true
    });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);

    /* =====================
       EARTH AXIAL TILT
    ===================== */
    const EARTH_TILT = THREE.MathUtils.degToRad(23.5);
    scene.rotation.z = EARTH_TILT;

    /* =====================
       GLITTER TEXTURE
    ===================== */
    function createGlitterTexture() {
      const size = 32;
      const c = document.createElement('canvas');
      c.width = c.height = size;
      const ctx = c.getContext('2d');

      const gradient = ctx.createRadialGradient(
        size / 2, size / 2, 0,
        size / 2, size / 2, size / 2
      );
      gradient.addColorStop(0, 'rgba(255,255,255,1)');
      gradient.addColorStop(0.3, 'rgba(0,255,255,0.8)');
      gradient.addColorStop(0.6, 'rgba(0,255,255,0.4)');
      gradient.addColorStop(1, 'rgba(0,255,255,0)');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, size, size);

      return new THREE.CanvasTexture(c);
    }

    const glitterTexture = createGlitterTexture();

    /* =====================
       DIGIT TEXTURES
    ===================== */
    function createDigitTextures() {
      const textures = [];
      const size = 32;

      for (let digit = 0; digit <= 9; digit++) {
        const c = document.createElement('canvas');
        c.width = c.height = size;
        const ctx = c.getContext('2d');

        ctx.clearRect(0, 0, size, size);
        ctx.font = 'bold 24px "Courier New", monospace';
        ctx.fillStyle = '#00ffdd';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowColor = '#00ffdd';
        ctx.shadowBlur = 4;
        ctx.fillText(digit.toString(), size / 2, size / 2);

        textures.push(new THREE.CanvasTexture(c));
      }
      return textures;
    }

    const digitTextures = createDigitTextures();

    /* =====================
       PARTICLES
    ===================== */
    const sprites = [];
    const COUNT_INNER = 1000;
    const COUNT_OUTER = 1500;
    const RADIUS = 70;
    const HALO_MIN = 80;
    const HALO_MAX = 120;

    /* ===== INNER ===== */
    for (let i = 0; i < COUNT_INNER; i++) {
      const material = new THREE.SpriteMaterial({
        map: digitTextures[Math.floor(Math.random() * 10)],
        transparent: true,
        opacity: Math.random() * 0.8 + 0.2,
        depthWrite: false
      });

      const sprite = new THREE.Sprite(material);

      const u = Math.random();
      const v = Math.random();
      const phi = Math.acos(
        THREE.MathUtils.lerp(
          Math.cos(Math.PI * 0.45),
          Math.cos(Math.PI * 0.55),
          u
        )
      );
      const theta = 2 * Math.PI * v;

      sprite.userData = {
        theta,
        phi,
        radius: RADIUS,
        twinkleSpeed: Math.random() * 0.04 + 0.01,
        orbitSpeed: Math.random() * 0.001 + 0.0005,
        parallaxStrength: 1.2
      };

      sprite.position.set(
        RADIUS * Math.sin(phi) * Math.cos(theta),
        RADIUS * Math.sin(phi) * Math.sin(theta),
        RADIUS * Math.cos(phi)
      );

      sprites.push(sprite);
      scene.add(sprite);
    }

    /* ===== OUTER HALO ===== */
    for (let i = 0; i < COUNT_OUTER; i++) {
      const material = new THREE.SpriteMaterial({
        map: digitTextures[Math.floor(Math.random() * 10)],
        transparent: true,
        opacity: Math.random() * 0.4 + 0.05,
        depthWrite: false
      });

      const sprite = new THREE.Sprite(material);

      const theta = Math.random() * Math.PI * 2;
      const phi = Math.acos(2 * Math.random() - 1);
      const radius = Math.random() * (HALO_MAX - HALO_MIN) + HALO_MIN;

      sprite.userData = {
        theta,
        phi,
        radius,
        twinkleSpeed: Math.random() * 0.03 + 0.005,
        orbitSpeed: Math.random() * 0.0006 + 0.0003,
        parallaxStrength: 0.35
      };

      sprite.position.set(
        radius * Math.sin(phi) * Math.cos(theta),
        radius * Math.sin(phi) * Math.sin(theta),
        radius * Math.cos(phi)
      );

      sprites.push(sprite);
      scene.add(sprite);
    }

    /* =====================
       ATMOSPHERE
    ===================== */
    const atmosphere = new THREE.Sprite(
      new THREE.SpriteMaterial({
        map: glitterTexture,
        transparent: true,
        opacity: 0.18,
        depthWrite: false
      })
    );
    atmosphere.scale.set(220, 220, 1);
    scene.add(atmosphere);

    /* =====================
       MOUSE + PARALLAX
    ===================== */
    const mouse = new THREE.Vector2(999, 999);
    const raycaster = new THREE.Raycaster();
    const parallax = { x: 0, y: 0 };

    window.addEventListener("mousemove", e => {
      if (!isDesktop()) return;

      mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;

      parallax.x = (e.clientX / window.innerWidth - 0.5) * 2;
      parallax.y = (e.clientY / window.innerHeight - 0.5) * 2;
    });

    function getMouse3D() {
      const plane = new THREE.Plane(new THREE.Vector3(0, 0, 1), -60);
      raycaster.setFromCamera(mouse, camera);
      const point = new THREE.Vector3();
      raycaster.ray.intersectPlane(plane, point);
      return point;
    }

    /* =====================
       ANIMATION LOOP
    ===================== */
    function animate() {
      requestAnimationFrame(animate);

      scene.rotation.y += 0.0006;
      atmosphere.rotation.y += 0.0004;

      // CAMERA PARALLAX
      if (isDesktop()) {
        camera.position.x += (parallax.x * 12 - camera.position.x) * 0.05;
        camera.position.y += (-parallax.y * 12 - camera.position.y) * 0.05;
      } else {
        camera.position.x += (0 - camera.position.x) * 0.05;
        camera.position.y += (0 - camera.position.y) * 0.05;
      }

      camera.lookAt(scene.position);

      const mousePos = isDesktop() ? getMouse3D() : null;

      sprites.forEach(sprite => {
        sprite.material.opacity +=
          (Math.random() - 0.5) * sprite.userData.twinkleSpeed;
        sprite.material.opacity = THREE.MathUtils.clamp(
          sprite.material.opacity, 0.1, 1
        );

        sprite.userData.theta += sprite.userData.orbitSpeed;

        const x =
          sprite.userData.radius *
          Math.sin(sprite.userData.phi) *
          Math.cos(sprite.userData.theta);
        const y =
          sprite.userData.radius *
          Math.sin(sprite.userData.phi) *
          Math.sin(sprite.userData.theta);
        const z =
          sprite.userData.radius *
          Math.cos(sprite.userData.phi);

        sprite.position.lerp(new THREE.Vector3(x, y, z), 0.05);

        // MOUSE REPULSION (DESKTOP ONLY)
        if (isDesktop()) {
          const dx = mousePos.x - sprite.position.x;
          const dy = mousePos.y - sprite.position.y;
          const dz = mousePos.z - sprite.position.z;
          const dist = Math.sqrt(dx * dx + dy * dy + dz * dz);

          if (dist < 40) {
            const force = (40 - dist) / 40;
            const p = sprite.userData.parallaxStrength;

            sprite.position.x += dx * force * 0.08 * p;
            sprite.position.y += dy * force * 0.08 * p;
            sprite.position.z += dz * force * 0.08 * p;
          }
        }
      });

      renderer.render(scene, camera);
    }

    animate();

    /* =====================
       RESIZE
    ===================== */
    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
  </script>
  <script src="./javascript/script.js"></script>
</body>

</html>